<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.0.min.js"></script>

    <title>Index</title>  
</head>  
<body class="container-fluid" >    

{% load crispy_forms_tags %}


<div class="row">
    <div class="col-6">
        <form method="post" class="post-form " id="movie-form" >
            {% csrf_token %}
            <!-- {{ form|crispy }} -->
            <table>{{ formm.as_table }}</table>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
          <a href="showm">Show All Movies</a>
        
    </div>

    <div class="col-6">
        
        <form class="post-form" id="actor-form">
            {% csrf_token %}
            <table>{{ forma.as_table }}</table>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        <a href="showa">Show All actors</a>

    </div>
</div>


<hr>

<table class="table table-striped table-bordered table-sm">  
    <thead class="thead-dark">  
    <tr>  
        <th>Movie Name</th>  
        <th>rating</th>  
        <th> cast</th>  
        <th> genre</th> 
        <th> release date </th> 

    </tr>  
    </thead>  
    <tbody>  
{% for movie in movies %}  
    <tr>  
        <td>{{ movie.movie_name }}</td>  
        <td>{{ movie.rating }}</td>  
        <td>{{ movie.cast }}</td>  
        <td>{{ movie.genre }}</td> 
        <td>{{ movie.release_data }}</td>  
        
    </tr>  
{% endfor %}  
    </tbody>  
</table>  
<table class="table table-striped table-bordered table-sm">  
    <thead class="thead-dark">  
    <tr>  
        <th>Actor Name</th>  
        <th>Age</th>  
        <th>lead</th>  
        <th>movie</th>  
    </tr>  
    </thead>  
    <tbody>  
        {% for actor in actors %}  
            <tr>  
                <td>{{ actor.actor_name }}</td>  
                <td>{{ actor.age }}</td>  
                <td>{{ actor.lead }}</td>  
                <!-- <td>{{ actor.movie.all }}</td>   -->
                    {% for m in actor.movie.all %}
                    <td>{{m}}</td>
                    {% endfor %}
                
            </tr>  
        {% endfor %}  
            </tbody>  
        </table>  
</table>  
<br>  
<br>    


<script>

jQuery(document).ready(function($){

     $("#actor-form").submit(function (e) {
        // preventing from page reload and default actions
        e.preventDefault();
        // serialize the data for sending the form data.
        var serializedData = $(this).serialize();
        console.log(serializedData);
        // make POST ajax call
        $.ajax({
            type: 'POST',
            url: "{% url 'addaajax' %}",
            data: serializedData,
            success: function (response) {
                console.log("data added")
            },
            error: function (response) {
                // alert the error if any error occured
                alert(response["responseJSON"]["error"]);
            }
        })
    })

    $("#movie-form").submit(function (e) {
        // preventing from page reload and default actions
        e.preventDefault();
        // serialize the data for sending the form data.
        var serializedData = $(this).serialize();
        console.log(serializedData);
        // make POST ajax call
        $.ajax({
            type: 'POST',
            url: "{% url 'addmajax' %}",
            data: serializedData,
            success: function (response) {
                console.log("data added")
            },
            error: function (response) {
                // alert the error if any error occured
                alert(response["responseJSON"]["error"]);
            }
        })
    })

})
    
</script>



</body>  
</html>  